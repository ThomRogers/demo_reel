"""
Grab data from forecastio.com using their API and write selected values
to csv file
"""
import requests
import csv
import time
from datetime import datetime

__author__ = 'Thom Rogers'
__python_version_used__ = 'Python 3.4'
__originally_created__ = 'Sept 2015'


def closest_under(target):
    """
    Looks up values corresponding to key that is closest (prior to target) in
     *sorted* keylist
      :param: integer representing UTC unix timestamp
      :return: integer of closest key in keylist that does not exceed target

      NOTE:
      format for each entry:
      key: UTC time
        values: (moonphase, change in moonphase per second as derived from
        previous exact moonphase)
        exact moonphases are 0.0 = new moon, 0.25 = first quarter
                             0.5 = full moon, 0.75 = last quarter
    UNIX UTC times for historical exact moonphases culled from
    http://aa.usno.navy.mil/data/docs/MoonPhase.php
    accessed 2015-09-19
    """
    lookup_dict = {946501440: (0.75, 0.000000354007363353158),
                   947207640: (0, 0.000000370699881376038),
                   947882040: (0.25, 0.00000043648299462253),
                   948454800: (0.5, 0.000000405436087055237),
                   949071420: (0.75, 0.000000352331022041829),
                   949780980: (0, 0.000000389480899856671),
                   950422860: (0.25, 0.000000431064211324919),
                   951002820: (0.5, 0.000000386984923067397),
                   951648840: (0.75, 0.000000359102530954638),
                   952345020: (0, 0.000000409218882996137),
                   952955940: (0.25, 0.000000418971007206301),
                   953552640: (0.5, 0.000000370140060999082),
                   954228060: (0.75, 0.000000375679980765185),
                   954893520: (0, 0.000000425256855140505),
                   955481400: (0.25, 0.000000403277842302233),
                   956101320: (0.5, 0.0000003583304666896),
                   956799000: (0.75, 0.000000393007608627303),
                   957435120: (0, 0.000000434525671776689),
                   958010460: (0.25, 0.000000386769392617346),
                   958656840: (0.5, 0.00000035367682426506),
                   959363700: (0.75, 0.000000412582103838664),
                   959969640: (0, 0.000000436071864643293),
                   960542940: (0.25, 0.00000037142687347715),
                   961216020: (0.5, 0.000000356949084782547),
                   961916400: (0.75, 0.000000427789185489391),
                   962500800: (0, 0.000000429863475360226),
                   963082380: (0.25, 0.000000359753640706844),
                   963777300: (0.5, 0.000000367204253694075),
                   964458120: (0.75, 0.000000435707065425773),
                   965031900: (0, 0.00000041679170417792),
                   965631720: (0.25, 0.000000353977288817149),
                   966337980: (0.5, 0.000000382333149813421),
                   966991860: (0.75, 0.000000435479375696767),
                   967565940: (0, 0.000000398800408371618),
                   968192820: (0.25, 0.000000355821235411329),
                   968895420: (0.5, 0.000000399450356309718),
                   969521280: (0.75, 0.000000427569693860099),
                   970105980: (0, 0.000000379270586807452),
                   970765140: (0.25, 0.000000365689544204552),
                   971448780: (0.5, 0.000000415586142695658),
                   972050340: (0.75, 0.000000413400800343949),
                   972655080: (0, 0.000000360781597252287),
                   973348020: (0.25, 0.000000381982642708715),
                   974002500: (0.5, 0.000000428272861205331),
                   974586240: (0.75, 0.000000395057046237477),
                   975219060: (0, 0.00000035298768778945),
                   975927300: (0.25, 0.00000040110383776152),
                   976550580: (0.5, 0.000000435024709403494),
                   977125260: (0.75, 0.000000376019011521223),
                   977790120: (0, 0.000000352211890673429),
                   978499920: (0.25, 0.000000418676312968918),
                   979097040: (0.5, 0.00000043353102348004),
                   979673700: (0.75, 0.000000360687903970452),
                   980366820: (0, 0.000000359971202303816),
                   981061320: (0.25, 0.000000430885901413306),
                   981641520: (0.5, 0.00000042292597103803),
                   982232640: (0.75, 0.000000352599362500353),
                   982941660: (0, 0.000000373960390115479),
                   983610180: (0.25, 0.000000435843793584379),
                   984183780: (0.5, 0.000000405238928872463),
                   984800700: (0.75, 0.000000353227082626879),
                   985508460: (0, 0.00000039352726356882),
                   986143740: (0.25, 0.000000432540918370878),
                   986721720: (0.5, 0.000000385481234773491),
                   987370260: (0.75, 0.000000361846866406137),
                   988061160: (0, 0.000000409218882996137),
                   988672080: (0.25, 0.000000421514078570224),
                   989265180: (0.5, 0.000000368796837198324),
                   989943060: (0.75, 0.000000376222723852521),
                   990607560: (0, 0.000000425039953755653),
                   991195740: (0.25, 0.000000404923874311629),
                   991813140: (0.5, 0.000000358299653165936),
                   992510880: (0.75, 0.000000393452943028014),
                   993146280: (0, 0.000000435752631945897),
                   993720000: (0.25, 0.00000038637487636004),
                   994367040: (0.5, 0.000000354881753399767),
                   995071500: (0.75, 0.000000410954400499721),
                   995679840: (0, 0.00000043841189674523),
                   996250080: (0.25, 0.000000369778724411312),
                   996926160: (0.5, 0.000000358053335624875),
                   997624380: (0.75, 0.000000425952429632659),
                   998211300: (0, 0.000000431331953071084),
                   998790900: (0.25, 0.0000003583304666896),
                   999488580: (0.5, 0.000000366880925126941),
                   1000170000: (0.75, 0.000000435524894602976),
                   1000744020: (0, 0.000000415669060920458),
                   1001345460: (0.25, 0.000000353766910058301),
                   1002052140: (0.5, 0.000000380482756521474),
                   1002709200: (0.75, 0.000000436620210276293),
                   1003281780: (0, 0.000000395507040025312),
                   1003913880: (0.25, 0.000000354821311987283),
                   1004618460: (0.5, 0.000000397582697201018),
                   1005247260: (0.75, 0.000000427833110860116),
                   1005831600: (0, 0.000000376019011521223),
                   1006496460: (0.25, 0.000000366525920713113),
                   1007178540: (0.5, 0.00000041571053244205),
                   1007779920: (0.75, 0.00000041111659266568),
                   1008388020: (0, 0.000000361407465232602),
                   1009079760: (0.25, 0.000000382087727342198),
                   1009734060: (0.5, 0.000000430707738956654),
                   1010314500: (0.75, 0.000000391089418684688),
                   1010953740: (0, 0.000000353766910058301),
                   1011660420: (0.25, 0.000000401296991877749),
                   1012283400: (0.5, 0.000000437537190661206),
                   1012854780: (0.75, 0.000000373089780324737),
                   1013524860: (0, 0.00000035367682426506),
                   1014231720: (0.25, 0.000000420238695579089),
                   1014826620: (0.5, 0.000000433666389120178),
                   1015403100: (0.75, 0.000000360500663321221),
                   1016096580: (0, 0.0000003609065973726),
                   1016789280: (0.25, 0.000000434163453857108),
                   1017365100: (0.5, 0.000000420705438879914),
                   1017959340: (0.75, 0.000000356369027255103),
                   1018660860: (0, 0.000000374464515742488),
                   1019328480: (0.25, 0.000000438966146930749),
                   1019898000: (0.5, 0.0000004031217750258),
                   1020518160: (0.75, 0.000000355244834740103),
                   1021221900: (0, 0.000000392452356283947),
                   1021858920: (0.25, 0.000000433621257848545),
                   1022435460: (0.5, 0.000000385303002280994),
                   1023084300: (0.75, 0.000000362287337332986),
                   1023774360: (0, 0.000000411603938226481),
                   1024381740: (0.25, 0.00000042032348095094),
                   1024976520: (0.5, 0.000000370140060999082),
                   1025651940: (0.75, 0.000000375138801356502),
                   1026318360: (0, 0.000000427745269137323),
                   1026902820: (0.25, 0.000000402965828497743),
                   1027523220: (0.5, 0.000000359350294667242),
                   1028218920: (0.75, 0.000000392600270108986),
                   1028855700: (0, 0.000000436894900562721),
                   1029427920: (0.25, 0.000000385196141875443),
                   1030076940: (0.5, 0.000000354248143739727),
                   1030782660: (0.75, 0.000000411766643607735),
                   1031389800: (0, 0.000000436849094848676),
                   1031962080: (0.25, 0.000000369680300476148),
                   1032638340: (0.5, 0.00000035600364547733),
                   1033340580: (0.75, 0.000000428008902585174),
                   1033924680: (0, 0.000000428008902585174),
                   1034508780: (0.25, 0.000000358361285513603),
                   1035206400: (0.5, 0.000000363329845366818),
                   1035894480: (0.75, 0.00000043648299462253),
                   1036467240: (0, 0.00000041262296164257),
                   1037073120: (0.25, 0.000000353047506072417),
                   1037781240: (0.5, 0.000000381144041956336),
                   1038437160: (0.75, 0.000000434570991517174),
                   1039012440: (0, 0.000000394011032308905),
                   1039646940: (0.25, 0.000000355487301993573),
                   1040350200: (0.5, 0.000000400602506169279),
                   1040974260: (0.75, 0.000000423786276105235),
                   1041564180: (0, 0.000000375646111311456),
                   1042229700: (0.25, 0.000000366364782086228),
                   1042912080: (0.5, 0.000000418971007206301),
                   1043508780: (0.75, 0.000000407896883667809),
                   1044121680: (0, 0.000000360969129920009),
                   1044814260: (0.25, 0.000000384378843788438),
                   1045464660: (0.5, 0.000000431555325392715),
                   1046043960: (0.75, 0.000000390539569469179),
                   1046684100: (0, 0.000000353107344632768),
                   1047392100: (0.25, 0.000000405317769130999),
                   1048008900: (0.5, 0.000000436026231338077),
                   1048582260: (0.75, 0.000000374430865085071),
                   1049249940: (0, 0.000000355487301993573),
                   1049953200: (0.25, 0.000000423613935204013),
                   1050543360: (0.5, 0.000000432137177625665),
                   1051121880: (0.75, 0.000000361784029405806),
                   1051812900: (0, 0.000000362381863512495),
                   1052502780: (0.25, 0.000000434797732095029),
                   1053077760: (0.5, 0.000000421088091628769),
                   1053671460: (0.75, 0.000000354640111215139),
                   1054376400: (0, 0.000000377142167511465),
                   1055039280: (0.25, 0.000000437307584662748),
                   1055610960: (0.5, 0.000000404963229338776),
                   1056228300: (0.75, 0.000000354489251885883),
                   1056933540: (0, 0.000000394832433115386),
                   1057566720: (0.25, 0.000000431823677755899),
                   1058145660: (0.5, 0.000000386518243661101),
                   1058792460: (0.75, 0.000000361941162844568),
                   1059483180: (0, 0.000000411929477673422),
                   1060090080: (0.25, 0.00000042002688172043),
                   1060685280: (0.5, 0.000000369385342789598),
                   1061362080: (0.75, 0.000000376120840103508),
                   1062026760: (0, 0.000000425691322708078),
                   1062614040: (0.25, 0.000000403668539688691),
                   1063233360: (0.5, 0.000000357132653352761),
                   1063933380: (0.75, 0.000000394346646476118),
                   1064567340: (0, 0.000000434027777777778),
                   1065143340: (0.25, 0.000000385160534910951),
                   1065792420: (0.5, 0.000000352390617952188),
                   1066501860: (0.75, 0.000000412582103838664),
                   1067107800: (0, 0.000000432451133021969),
                   1067685900: (0.25, 0.000000367820150659134),
                   1068365580: (0.5, 0.000000356064490400501),
                   1069067700: (0.75, 0.000000426737675815923),
                   1069653540: (0, 0.000000427920988668652),
                   1070237760: (0.25, 0.000000355487301993573),
                   1070941020: (0.5, 0.00000036726898780667),
                   1071621720: (0.75, 0.000000433982571259938),
                   1072197780: (0, 0.000000412541254125413),
                   1072803780: (0.25, 0.000000351409856343651),
                   1073515200: (0.5, 0.000000383459107920731),
                   1074167160: (0.75, 0.000000433170461239907),
                   1074744300: (0, 0.000000392415395240786),
                   1075381380: (0.25, 0.000000356613032066644),
                   1076082420: (0.5, 0.000000401683858735821),
                   1076704800: (0.75, 0.000000424390575134107),
                   1077293880: (0, 0.000000373156606364559),
                   1077963840: (0.25, 0.000000369713102632357),
                   1078640040: (0.5, 0.000000418886766529272),
                   1079236860: (0.75, 0.000000409299279633268),
                   1079847660: (0, 0.000000359598400506315),
                   1080542880: (0.25, 0.000000389590151160979),
                   1081184580: (0.5, 0.000000432092364063742),
                   1081763160: (0.75, 0.000000391052713905834),
                   1082402460: (0, 0.000000353977288817149),
                   1083108720: (0.25, 0.000000406068284442712),
                   1083724380: (0.5, 0.000000438089230014369),
                   1084295040: (0.75, 0.000000373759119722521),
                   1084963920: (0, 0.000000355973230813043),
                   1085666220: (0.25, 0.000000422454290445774),
                   1086258000: (0.5, 0.000000434843108606415),
                   1086832920: (0.75, 0.0000003609065973726),
                   1087525620: (0, 0.000000364187279666696),
                   1088212080: (0.25, 0.000000433982571259938),
                   1088788140: (0.5, 0.000000422368643351918),
                   1089380040: (0.75, 0.000000354609929078014),
                   1090085040: (0, 0.000000376971561265418),
                   1090748220: (0.25, 0.000000438227457579582),
                   1091318700: (0.5, 0.000000403903321700918),
                   1091937660: (0.75, 0.000000355426654155648),
                   1092641040: (0, 0.000000392785319255907),
                   1093277520: (0.25, 0.000000433576135969476),
                   1093854120: (0.5, 0.000000384059974805666),
                   1094505060: (0.75, 0.000000363013300807342),
                   1095193740: (0, 0.000000409903262829972),
                   1095803640: (0.25, 0.000000420238695579089),
                   1096398540: (0.5, 0.000000367333744747127),
                   1097079120: (0.75, 0.000000376188756470447),
                   1097743680: (0, 0.000000425560889252034),
                   1098331140: (0.25, 0.00000040110383776152),
                   1098954420: (0.5, 0.00000035473068846132),
                   1099659180: (0.75, 0.000000393304386130514),
                   1100294820: (0, 0.000000435707065425773),
                   1100868600: (0.25, 0.000000380969796714517),
                   1101524820: (0.5, 0.000000352927889773561),
                   1102233180: (0.75, 0.000000411888757084487),
                   1102840140: (0, 0.000000436254493421282),
                   1103413200: (0.25, 0.000000364665383044518),
                   1104098760: (0.5, 0.000000356735159817352),
                   1104799560: (0.75, 0.000000427920988668652),
                   1105383780: (0, 0.00000042630107086829),
                   1105970220: (0.25, 0.000000355063201249822),
                   1106674320: (0.5, 0.00000036759300102926),
                   1107354420: (0.75, 0.000000436711735317752),
                   1107926880: (0, 0.000000408977882476116),
                   1108538160: (0.25, 0.000000353167203480816),
                   1109246040: (0.5, 0.000000384307938264773),
                   1109896560: (0.75, 0.000000435206461945547),
                   1110471000: (0, 0.000000389808837745969),
                   1111112340: (0.25, 0.000000358577165806081),
                   1111809540: (0.5, 0.000000404099182103255),
                   1112428200: (0.75, 0.000000426825104145325),
                   1113013920: (0, 0.000000373190028362442),
                   1113683820: (0.25, 0.000000370403295107713),
                   1114358760: (0.5, 0.000000422668560221817),
                   1114950240: (0.75, 0.000000407657437302286),
                   1115563500: (0, 0.00000036131344664123),
                   1116255420: (0.25, 0.000000387200693863643),
                   1116901080: (0.5, 0.000000435433866304386),
                   1117475220: (0.75, 0.000000389845309381238),
                   1118116500: (0, 0.000000355305420539496),
                   1118820120: (0.25, 0.000000406424762647939),
                   1119435240: (0.5, 0.000000439104928513718),
                   1120004580: (0.75, 0.000000374061106622378),
                   1120672920: (0, 0.00000035557831256756),
                   1121376000: (0.25, 0.000000424304141208418),
                   1121965200: (0.5, 0.000000433170461239907),
                   1122542340: (0.75, 0.00000036212990323889),
                   1123232700: (0, 0.000000362507975175454),
                   1123922340: (0.25, 0.000000436117507501221),
                   1124495580: (0.5, 0.000000419815281276239),
                   1125091080: (0.75, 0.000000355305420539496),
                   1125794700: (0, 0.000000375646111311456),
                   1126460220: (0.25, 0.00000043841189674523),
                   1127030460: (0.5, 0.000000402187902187902),
                   1127652060: (0.75, 0.000000354700490905479),
                   1128356880: (0, 0.000000393341514836842),
                   1128992460: (0.25, 0.000000430752265756918),
                   1129572840: (0.5, 0.000000383565006597318),
                   1130224620: (0.75, 0.00000035956736854217),
                   1130919900: (0, 0.000000412051687763713),
                   1131526620: (0.25, 0.000000415793500316003),
                   1132127880: (0.5, 0.000000367010188202825),
                   1132809060: (0.75, 0.000000375713856327021),
                   1133474460: (0, 0.000000427131385614215),
                   1134059760: (0.25, 0.000000397582697201018),
                   1134688560: (0.5, 0.00000035551763367463),
                   1135391760: (0.75, 0.000000395469501392053),
                   1136023920: (0, 0.000000434752365052866),
                   1136598960: (0.25, 0.000000379754526673958),
                   1137257280: (0.5, 0.000000351736169733806),
                   1137968040: (0.75, 0.000000415793500316003),
                   1138569300: (0, 0.000000433395742320228),
                   1139146140: (0.25, 0.000000365016790772376),
                   1139831040: (0.5, 0.000000356949084782547),
                   1140531420: (0.75, 0.000000430707738956654),
                   1141111860: (0, 0.000000424088210347752),
                   1141701360: (0.25, 0.000000355547970532184),
                   1142404500: (0.5, 0.00000037017294479981),
                   1143079860: (0.75, 0.000000436574462140263),
                   1143652500: (0, 0.000000411481993547962),
                   1144260060: (0.25, 0.000000353137271520185),
                   1144968000: (0.5, 0.00000038839174745215),
                   1145611680: (0.75, 0.00000043330560177482),
                   1146188640: (0, 0.000000391273045982408),
                   1146827580: (0.25, 0.000000358638893670741),
                   1147524660: (0.5, 0.000000407298794395569),
                   1148138460: (0.75, 0.00000042322668020992),
                   1148729160: (0, 0.000000374027528426092),
                   1149397560: (0.25, 0.000000371459986330273),
                   1150070580: (0.5, 0.00000042322668020992),
                   1150661280: (0.75, 0.000000408616913471282),
                   1151273100: (0, 0.000000360687903970452),
                   1151966220: (0.25, 0.000000389226218278063),
                   1152608520: (0.5, 0.00000043353102348004),
                   1153185180: (0.75, 0.000000391677633640409),
                   1153823460: (0, 0.000000353857041755131),
                   1154529960: (0.25, 0.000000408176593521421),
                   1155142440: (0.5, 0.000000436894900562721),
                   1155714660: (0.75, 0.000000374733938903379),
                   1156381800: (0, 0.00000035473068846132),
                   1157086560: (0.25, 0.00000042404505054617),
                   1157676120: (0.5, 0.000000432540918370878),
                   1158254100: (0.75, 0.000000360750360750361),
                   1158947100: (0, 0.000000362981676684961),
                   1159635840: (0.25, 0.000000433621257848545),
                   1160212380: (0.5, 0.00000042032348095094),
                   1160807160: (0.75, 0.000000352868112014453),
                   1161515640: (0, 0.0000003750037500375),
                   1162182300: (0.25, 0.000000435251923813503),
                   1162756680: (0.5, 0.00000040191633709527),
                   1163378700: (0.75, 0.000000353316939427344),
                   1164086280: (0, 0.000000394160123608615),
                   1164720540: (0.25, 0.000000428845889940991),
                   1165303500: (0.5, 0.000000381318446661176),
                   1165959120: (0.75, 0.000000362665738242377),
                   1166648460: (0, 0.000000411441361377177),
                   1167256080: (0.25, 0.000000415461827367302),
                   1167857820: (0.5, 0.000000363964593524342),
                   1168544700: (0.75, 0.000000378925669940584),
                   1169204460: (0, 0.000000426039536468984),
                   1169791260: (0.25, 0.000000397431005977362),
                   1170420300: (0.5, 0.000000354127712618279),
                   1171126260: (0.75, 0.000000398228678836535),
                   1171754040: (0, 0.000000434843108606415),
                   1172328960: (0.25, 0.000000378753446656365),
                   1172989020: (0.5, 0.000000355002698020505),
                   1173693240: (0.75, 0.00000041629200386319),
                   1174293780: (0, 0.000000435251923813503),
                   1174868160: (0.25, 0.000000363615207842453),
                   1175555700: (0.5, 0.000000360157893220388),
                   1176249840: (0.75, 0.000000429907827761728),
                   1176831360: (0, 0.000000426039536468984),
                   1177418160: (0.25, 0.000000355123725105827),
                   1178122140: (0.5, 0.000000372756008826862),
                   1178792820: (0.75, 0.00000043675751222921),
                   1179365220: (0, 0.000000409460167714885),
                   1179975780: (0.25, 0.000000354278264319927),
                   1180681440: (0.5, 0.000000388717853033554),
                   1181324580: (0.75, 0.000000435388366422849),
                   1181898780: (0, 0.000000390064282593771),
                   1182539700: (0.25, 0.000000360625468813109),
                   1183232940: (0.5, 0.000000405910050332846),
                   1183848840: (0.75, 0.000000425604358188628),
                   1184436240: (0, 0.000000372522723886157),
                   1185107340: (0.25, 0.000000372722664519784),
                   1185778080: (0.5, 0.000000422069151809833),
                   1186370400: (0.75, 0.000000409218882996137),
                   1186981320: (0, 0.000000360064523562622),
                   1187675640: (0.25, 0.000000388645337810528),
                   1188318900: (0.5, 0.000000434163453857108),
                   1188894720: (0.75, 0.000000389699463773538),
                   1189536240: (0, 0.000000354187917941743),
                   1190242080: (0.25, 0.000000406226641968087),
                   1190857500: (0.5, 0.000000438550328035645),
                   1191427560: (0.75, 0.000000371526229751821),
                   1192100460: (0, 0.000000355153994772133),
                   1192804380: (0.25, 0.000000422625688879873),
                   1193395920: (0.5, 0.000000432855460904495),
                   1193973480: (0.75, 0.000000356582513193553),
                   1194674580: (0, 0.000000362634174644619),
                   1195363980: (0.25, 0.000000434163453857108),
                   1195939800: (0.5, 0.00000041775282400909),
                   1196538240: (0.75, 0.000000352629203340104),
                   1197247200: (0, 0.000000376120840103508),
                   1197911880: (0.25, 0.000000436849094848676),
                   1198484160: (0.5, 0.000000397772474144789),
                   1199112660: (0.75, 0.00000035473068846132),
                   1199817420: (0, 0.000000394234711577885),
                   1200451560: (0.25, 0.000000429155079479521),
                   1201034100: (0.5, 0.000000378512596899225),
                   1201694580: (0.75, 0.000000364155450678786),
                   1202381100: (0, 0.00000041385246987154),
                   1202985180: (0.25, 0.000000413482848731435),
                   1203589800: (0.5, 0.000000363964593524342),
                   1204276680: (0.75, 0.000000379616132167153),
                   1204935240: (0, 0.000000432585825027686),
                   1205513160: (0.25, 0.000000394795022424357),
                   1206146400: (0.5, 0.000000355912417072407),
                   1206848820: (0.75, 0.000000398800408371618),
                   1207475700: (0, 0.00000043781303632097),
                   1208046720: (0.25, 0.000000377654914045742),
                   1208708700: (0.5, 0.000000354700490905479),
                   1209413520: (0.75, 0.000000418088166432537),
                   1210011480: (0, 0.000000435433866304386),
                   1210585620: (0.25, 0.000000364729225023343),
                   1211271060: (0.5, 0.000000360251311314773),
                   1211965020: (0.75, 0.000000432855460904495),
                   1212542580: (0, 0.000000424260937446967),
                   1213131840: (0.25, 0.00000035716326647237),
                   1213831800: (0.5, 0.00000037202380952381),
                   1214503800: (0.75, 0.000000439104928513718),
                   1215073140: (0, 0.000000407856956408249),
                   1215686100: (0.25, 0.000000355396337996133),
                   1216389540: (0.5, 0.00000038857284963785),
                   1217032920: (0.75, 0.000000435342876049176),
                   1217607180: (0, 0.000000389881787841926),
                   1218248400: (0.25, 0.000000359940105966367),
                   1218942960: (0.5, 0.000000407139600026057),
                   1219557000: (0.75, 0.000000423097752504739),
                   1220147880: (0, 0.000000373156606364559),
                   1220817840: (0.25, 0.000000371063021343545),
                   1221491580: (0.5, 0.000000423829383243482),
                   1222081440: (0.75, 0.00000040579145565511),
                   1222697520: (0, 0.000000360064523562622),
                   1223391840: (0.25, 0.000000388030049046998),
                   1224036120: (0.5, 0.000000434344487299767),
                   1224611700: (0.75, 0.000000387272670942157),
                   1225257240: (0, 0.000000351054567922038),
                   1225969380: (0.25, 0.000000407936818745513),
                   1226582220: (0.5, 0.000000436117507501221),
                   1227155460: (0.75, 0.000000370568006640579),
                   1227830100: (0, 0.000000353376869363639),
                   1228537560: (0.25, 0.000000425560889252034),
                   1229125020: (0.5, 0.000000429022515101593),
                   1229707740: (0.75, 0.000000358176452047337),
                   1230405720: (0, 0.000000362507975175454),
                   1231095360: (0.25, 0.000000435342876049176),
                   1231669620: (0.5, 0.000000415047979546436),
                   1232271960: (0.75, 0.000000352241665962183),
                   1232981700: (0, 0.000000378856761835485),
                   1233641580: (0.25, 0.000000435115566694514),
                   1234216140: (0.5, 0.000000397279430460208),
                   1234845420: (0.75, 0.000000354368656801043),
                   1235550900: (0, 0.000000398685931170861),
                   1236177960: (0.25, 0.000000429022515101593),
                   1236760680: (0.5, 0.000000379167045833713),
                   1237420020: (0.75, 0.000000364888927810375),
                   1238105160: (0, 0.000000417167267387532),
                   1238704440: (0.25, 0.000000412459578961262),
                   1239310560: (0.5, 0.000000364219114219114),
                   1239996960: (0.75, 0.000000382017664496806),
                   1240651380: (0, 0.000000430396308921255),
                   1241232240: (0.25, 0.000000396183956134512),
                   1241863260: (0.5, 0.000000355366027007818),
                   1242566760: (0.75, 0.000000401993889692877),
                   1243188660: (0, 0.000000436254493421282),
                   1243761720: (0.25, 0.000000379823761774537),
                   1244419920: (0.5, 0.000000354218028280767),
                   1245125700: (0.75, 0.00000042002688172043),
                   1245720900: (0, 0.000000434344487299767),
                   1246296480: (0.25, 0.000000365721641943884),
                   1246980060: (0.5, 0.000000360687903970452),
                   1247673180: (0.75, 0.000000432137177625665),
                   1248251700: (0, 0.000000424953255141934),
                   1248840000: (0.25, 0.000000356277611514892),
                   1249541700: (0.5, 0.000000373357228195938),
                   1250211300: (0.75, 0.000000436437275234803),
                   1250784120: (0, 0.000000409299279633268),
                   1251394920: (0.25, 0.00000035367682426506),
                   1252101780: (0.5, 0.000000389663019420805),
                   1252743360: (0.75, 0.000000432765544938374),
                   1253321040: (0, 0.000000389918273129952),
                   1253962200: (0.25, 0.000000359195402298851),
                   1254658200: (0.5, 0.000000406662762704145),
                   1255272960: (0.75, 0.000000421855489183625),
                   1255865580: (0, 0.000000371063021343545),
                   1256539320: (0.25, 0.000000370304538452423),
                   1257214440: (0.5, 0.000000421642042771369),
                   1257807360: (0.75, 0.000000405396640072647),
                   1258424040: (0, 0.000000357193884840692),
                   1259123940: (0.25, 0.000000390466373035954),
                   1259764200: (0.5, 0.000000432092364063742),
                   1260342780: (0.75, 0.000000386195816726913),
                   1260990120: (0, 0.000000351498790844159),
                   1261701360: (0.25, 0.000000409419933837739),
                   1262311980: (0.5, 0.000000435570423025995),
                   1262885940: (0.75, 0.000000368340405469118),
                   1263564660: (0, 0.000000354851530119798),
                   1264269180: (0.25, 0.000000424953255141934),
                   1264857480: (0.5, 0.00000042999656002752),
                   1265438880: (0.75, 0.000000356034065339372),
                   1266141060: (0, 0.000000365785854329441),
                   1266824520: (0.25, 0.00000043420869806864),
                   1267400280: (0.5, 0.000000415669060920458),
                   1268001720: (0.75, 0.000000353736876361887),
                   1268708460: (0, 0.000000381597826418781),
                   1269363600: (0.25, 0.00000043561596096881),
                   1269937500: (0.5, 0.000000396372399797057),
                   1270568220: (0.75, 0.000000356369027255103),
                   1271269740: (0, 0.000000399450356309718),
                   1271895600: (0.25, 0.000000428757631885848),
                   1272478680: (0.5, 0.000000377518045362568),
                   1273140900: (0.75, 0.000000367787683526054),
                   1273820640: (0, 0.000000416708337500417),
                   1274420580: (0.25, 0.000000414841364662153),
                   1275023220: (0.5, 0.000000363393220536078),
                   1275711180: (0.75, 0.000000383600319155466),
                   1276362900: (0, 0.000000430707738956654),
                   1276943340: (0.25, 0.000000396787607529442),
                   1277573400: (0.5, 0.000000355973230813043),
                   1278275700: (0.75, 0.000000401219707912053),
                   1278898800: (0, 0.00000043813529617946),
                   1279469400: (0.25, 0.000000378546985251809),
                   1280129820: (0.5, 0.000000355456975487687),
                   1280833140: (0.75, 0.000000417962349951516),
                   1281431280: (0, 0.00000043648299462253),
                   1282004040: (0.25, 0.000000363869239949932),
                   1282691100: (0.5, 0.000000361156857646413),
                   1283383320: (0.75, 0.000000430975037925803),
                   1283963400: (0, 0.000000425170068027211),
                   1284551400: (0.25, 0.000000355305420539496),
                   1285255020: (0.5, 0.000000372189965758523),
                   1285926720: (0.75, 0.000000437124073296965),
                   1286498640: (0, 0.000000406781867291484),
                   1287113220: (0.25, 0.000000354037442999972),
                   1287819360: (0.5, 0.000000387596899224806),
                   1288464360: (0.75, 0.00000043375667985287),
                   1289040720: (0, 0.000000384130788850988),
                   1289691540: (0.25, 0.000000360189027201475),
                   1290385620: (0.5, 0.000000405751939494271),
                   1291001760: (0.75, 0.000000420875420875421),
                   1291595760: (0, 0.00000036863369606889),
                   1292273940: (0.25, 0.000000372889445737128),
                   1292944380: (0.5, 0.00000042322668020992),
                   1293535080: (0.75, 0.000000401993889692877),
                   1294156980: (0, 0.000000357102045480516),
                   1294857060: (0.25, 0.000000390502967822555),
                   1295497260: (0.5, 0.000000435115566694514),
                   1296071820: (0.75, 0.000000382473532831528),
                   1296725460: (0, 0.000000352897998362553),
                   1297433880: (0.25, 0.000000410185732099495),
                   1298043360: (0.5, 0.00000043721580972368),
                   1298615160: (0.75, 0.000000366784037558685),
                   1299296760: (0, 0.000000356155796791749),
                   1299998700: (0.25, 0.00000043021855102392),
                   1300579800: (0.5, 0.000000428801756371994),
                   1301162820: (0.75, 0.000000357193884840692),
                   1301862720: (0, 0.000000366364782086228),
                   1302545100: (0.25, 0.000000437721049129811),
                   1303116240: (0.5, 0.000000413236801216569),
                   1303721220: (0.75, 0.000000354187917941743),
                   1304427060: (0, 0.000000382192869809821),
                   1305081180: (0.25, 0.000000437859044416422),
                   1305652140: (0.5, 0.000000395206930348731),
                   1306284720: (0.75, 0.00000035762309386891),
                   1306983780: (0, 0.00000040110383776152),
                   1307607060: (0.25, 0.000000428537145599781),
                   1308190440: (0.5, 0.000000378306397917802),
                   1308851280: (0.75, 0.000000367236617897644),
                   1309532040: (0, 0.000000419392719342392),
                   1310128140: (0.25, 0.000000412909193010273),
                   1310733600: (0.5, 0.000000364793089359715),
                   1311418920: (0.75, 0.000000382333149813421),
                   1312072800: (0, 0.000000432765544938374),
                   1312650480: (0.25, 0.000000394982146806964),
                   1313283420: (0.5, 0.000000356216693739135),
                   1313985240: (0.75, 0.00000040102662816811),
                   1314608640: (0, 0.000000437905062182519),
                   1315179540: (0.25, 0.000000377826139523637),
                   1315841220: (0.5, 0.000000353947219390644),
                   1316547540: (0.75, 0.000000419603893924136),
                   1317143340: (0, 0.00000043375667985287),
                   1317719700: (0.25, 0.000000363869239949932),
                   1318406760: (0.5, 0.000000359071584511088),
                   1319103000: (0.75, 0.000000432855460904495),
                   1319680560: (0, 0.000000421642042771369),
                   1320273480: (0.25, 0.000000353167203480816),
                   1320981360: (0.5, 0.000000371592496804305),
                   1321654140: (0.75, 0.000000436711735317752),
                   1322226600: (0, 0.000000404452209926875),
                   1322844720: (0.25, 0.00000035298768778945),
                   1323552960: (0.5, 0.000000389699463773538),
                   1324194480: (0.75, 0.000000430529723772129),
                   1324775160: (0, 0.000000385481234773491),
                   1325423700: (0.25, 0.000000359350294667242),
                   1326119400: (0.5, 0.00000040937970786664),
                   1326730080: (0.75, 0.00000041704200447069),
                   1327329540: (0, 0.000000368372970264934),
                   1328008200: (0.25, 0.000000373893275903326),
                   1328676840: (0.5, 0.000000425604358188628),
                   1329264240: (0.75, 0.000000400217718438831),
                   1329888900: (0, 0.000000356551999543613),
                   1330590060: (0.25, 0.000000393899287830088),
                   1331224740: (0.5, 0.000000437399398138428),
                   1331796300: (0.75, 0.000000383247485896493),
                   1332448620: (0, 0.000000352390617952188),
                   1333158060: (0.25, 0.000000414263935838802),
                   1333761540: (0.5, 0.000000435342876049176),
                   1334335800: (0.75, 0.000000368470699209999),
                   1335014280: (0, 0.000000356765704826326),
                   1335715020: (0.25, 0.000000429641850553379),
                   1336296900: (0.5, 0.000000428140841211125),
                   1336880820: (0.75, 0.000000357961053837343),
                   1337579220: (0, 0.000000368438117133846),
                   1338257760: (0.25, 0.000000436940715883669),
                   1338829920: (0.5, 0.000000414634955385279),
                   1339432860: (0.75, 0.00000035367682426506),
                   1340139720: (0, 0.00000038480482699175),
                   1340789400: (0.25, 0.000000435752631945897),
                   1341363120: (0.5, 0.00000039697662601626),
                   1341992880: (0.75, 0.00000035685737124586),
                   1342693440: (0, 0.000000402498712004122),
                   1343314560: (0.25, 0.000000427306601032373),
                   1343899620: (0.5, 0.000000378512596899225),
                   1344560100: (0.75, 0.000000367463327159949),
                   1345240440: (0, 0.000000418340026773762),
                   1345838040: (0.25, 0.00000041319582176385),
                   1346443080: (0.5, 0.000000363044930440591),
                   1347131700: (0.75, 0.000000383812331122574),
                   1347783060: (0, 0.00000042999656002752),
                   1348364460: (0.25, 0.00000039539444549883),
                   1348996740: (0.5, 0.000000353887095860937),
                   1349703180: (0.75, 0.000000402615389570651),
                   1350324120: (0, 0.000000435388366422849),
                   1350898320: (0.25, 0.000000376835187362455),
                   1351561740: (0.5, 0.000000351113732760316),
                   1352273760: (0.75, 0.00000041951939857699),
                   1352869680: (0, 0.000000432990404932627),
                   1353447060: (0.25, 0.000000361219476954197),
                   1354139160: (0.5, 0.000000360282461449777),
                   1354833060: (0.75, 0.000000430841346982387),
                   1355413320: (0, 0.000000421855489183625),
                   1356005940: (0.25, 0.000000352450234026955),
                   1356715260: (0.5, 0.000000374128281105025),
                   1357383480: (0.75, 0.000000434661659364351),
                   1357958640: (0, 0.000000403707651067403),
                   1358577900: (0.25, 0.000000352718756172578),
                   1359286680: (0.5, 0.000000391677633640409),
                   1359924960: (0.75, 0.000000430262976731378),
                   1360506000: (0, 0.000000383282740011652),
                   1361158260: (0.25, 0.000000361846866406137),
                   1361849160: (0.5, 0.00000040982262876627),
                   1362459180: (0.75, 0.000000420960463393278),
                   1363053060: (0, 0.000000366268166901078),
                   1363735620: (0.25, 0.000000377415458937198),
                   1364398020: (0.5, 0.000000425604358188628),
                   1364985420: (0.75, 0.000000401490332112803),
                   1365608100: (0, 0.0000003562471500228),
                   1366309860: (0.25, 0.000000395845208689594),
                   1366941420: (0.5, 0.000000435980607582575),
                   1367514840: (0.75, 0.000000383176997118509),
                   1368167280: (0, 0.000000354127712618279),
                   1368873240: (0.25, 0.000000413729189421772),
                   1369477500: (0.5, 0.000000437997126738849),
                   1370048280: (0.75, 0.00000036749573704945),
                   1370728560: (0, 0.000000358947852056053),
                   1371425040: (0.25, 0.000000428316885964912),
                   1372008720: (0.5, 0.000000430396308921255),
                   1372589580: (0.75, 0.000000357316410828117),
                   1373289240: (0, 0.000000369254401512466),
                   1373966280: (0.25, 0.000000436894900562721),
                   1374538500: (0.5, 0.000000414676220806794),
                   1375141380: (0.75, 0.000000354067527758894),
                   1375847460: (0, 0.000000383494400981746),
                   1376499360: (0.25, 0.000000437261692377654),
                   1377071100: (0.5, 0.000000394944707740916),
                   1377704100: (0.75, 0.000000357930303811242),
                   1378402560: (0, 0.000000400179280317582),
                   1379027280: (0.25, 0.000000428449014567267),
                   1379610780: (0.5, 0.000000375985080911989),
                   1380275700: (0.75, 0.000000368112613010572),
                   1380954840: (0, 0.000000417167267387532),
                   1381554120: (0.25, 0.000000411888757084487),
                   1382161080: (0.5, 0.000000361627032343922),
                   1382852400: (0.75, 0.000000381213784690454),
                   1383508200: (0, 0.000000431019620013103),
                   1384088220: (0.25, 0.000000391640818372654),
                   1384726560: (0.5, 0.000000353947219390644),
                   1385432880: (0.75, 0.000000401645138487244),
                   1386055320: (0, 0.00000043721580972368),
                   1386627120: (0.25, 0.0000003728227153424),
                   1387297680: (0.5, 0.000000353706847764573),
                   1388004480: (0.75, 0.000000419772986768755),
                   1388600040: (0, 0.000000432900432900433),
                   1389177540: (0.25, 0.000000359412289024986),
                   1389873120: (0.5, 0.000000360844086487111),
                   1390565940: (0.75, 0.000000433170461239907),
                   1391143080: (0, 0.000000419013140252078),
                   1391739720: (0.25, 0.000000353376869363639),
                   1392447180: (0.5, 0.000000374632859797399),
                   1393114500: (0.75, 0.000000437445319335083),
                   1393686000: (0, 0.000000400371544793569),
                   1394310420: (0.25, 0.000000356704620038239),
                   1395011280: (0.5, 0.000000393155941372586),
                   1395647160: (0.75, 0.000000431376609034752),
                   1396226700: (0, 0.000000382052692707378),
                   1396881060: (0.25, 0.000000363234824049051),
                   1397569320: (0.5, 0.000000412950115626032),
                   1398174720: (0.75, 0.000000417418019101049),
                   1398773640: (0, 0.000000367398524527526),
                   1399454100: (0.25, 0.000000377381275850617),
                   1400116560: (0.5, 0.000000429420454155072),
                   1400698740: (0.75, 0.000000399833669193615),
                   1401324000: (0, 0.000000357991809147407),
                   1402022340: (0.25, 0.000000395619698696038),
                   1402654260: (0.5, 0.000000438227457579582),
                   1403224740: (0.75, 0.000000382649156641259),
                   1403878080: (0, 0.000000354579752077837),
                   1404583140: (0.25, 0.000000414758776295706),
                   1405185900: (0.5, 0.000000437537190661206),
                   1405757280: (0.75, 0.000000368275293147133),
                   1406436120: (0, 0.000000357715201465201),
                   1407135000: (0.25, 0.000000430485242965871),
                   1407715740: (0.5, 0.000000427920988668652),
                   1408299960: (0.75, 0.000000358361285513603),
                   1408997580: (0, 0.00000036749573704945),
                   1409677860: (0.25, 0.000000438273552820729),
                   1410248280: (0.5, 0.000000412255532469246),
                   1410854700: (0.75, 0.000000354037442999972),
                   1411560840: (0, 0.000000383000888562061),
                   1412213580: (0.25, 0.000000435934993373788),
                   1412787060: (0.5, 0.000000393787606716441),
                   1413421920: (0.75, 0.000000356582513193553),
                   1414123020: (0, 0.000000401761321634044),
                   1414745280: (0.25, 0.000000421940928270042),
                   1415337780: (0.5, 0.000000375646111311456),
                   1416003300: (0.75, 0.000000366880925126941),
                   1416684720: (0, 0.000000419434937252533),
                   1417280760: (0.25, 0.000000407657437302286),
                   1417894020: (0.5, 0.000000360937860937861),
                   1418586660: (0.75, 0.000000384201629014907),
                   1419237360: (0, 0.000000431555325392715),
                   1419816660: (0.25, 0.000000389335326730206),
                   1420458780: (0.5, 0.000000352718756172578),
                   1421167560: (0.75, 0.000000405002592016589),
                   1421784840: (0, 0.000000435206461945547),
                   1422359280: (0.25, 0.000000372655993799004),
                   1423030140: (0.5, 0.000000353077422817275),
                   1423738200: (0.75, 0.000000423570871878283),
                   1424328420: (0, 0.000000430129727125701),
                   1424909640: (0.25, 0.000000360095641402356),
                   1425603900: (0.5, 0.000000364123627253925),
                   1426290480: (0.75, 0.000000434570991517174),
                   1426865760: (0, 0.000000418046219189994),
                   1427463780: (0.25, 0.000000353646805862049),
                   1428170700: (0.5, 0.000000378134736969477),
                   1428831840: (0.75, 0.000000436163159914861),
                   1429405020: (0, 0.000000401490332112803),
                   1430027700: (0.25, 0.000000354700490905479),
                   1430732520: (0.5, 0.000000397052283844737),
                   1431362160: (0.75, 0.000000429686157230759),
                   1431943980: (0, 0.000000383459107920731),
                   1432595940: (0.25, 0.000000363583478766725),
                   1433283540: (0.5, 0.00000041488267118059),
                   1433886120: (0.75, 0.000000417376206217236),
                   1434485100: (0, 0.000000367528152656494),
                   1435165320: (0.25, 0.000000378856761835485),
                   1435825200: (0.5, 0.000000428493075551899),
                   1436408640: (0.75, 0.000000401412973667309),
                   1437031440: (0, 0.000000356735159817352),
                   1437732240: (0.25, 0.0000003976206381016),
                   1438360980: (0.5, 0.000000435843793584379),
                   1438934580: (0.75, 0.000000384024577572965),
                   1439585580: (0, 0.000000353167203480816),
                   1440293460: (0.25, 0.000000415669060920458),
                   1440894900: (0.5, 0.000000435889388708721),
                   1441468440: (0.75, 0.000000367852623524911),
                   1442148060: (0, 0.000000357408360496369),
                   1442847540: (0.25, 0.000000429066694126935),
                   1443430200: (0.5, 0.000000427964941112024),
                   1444014360: (0.75, 0.000000356125356125356),
                   1444716360: (0, 0.000000368568480023588),
                   1445394660: (0.25, 0.000000435206461945547),
                   1445969100: (0.5, 0.000000410145355513994),
                   1446578640: (0.75, 0.000000351825269498156),
                   1447289220: (0, 0.000000384378843788438),
                   1447939620: (0.25, 0.000000433260545561679),
                   1448516640: (0.5, 0.000000392489324290379),
                   1449153600: (0.75, 0.000000356460489919297),
                   1449854940: (0, 0.000000401993889692877),
                   1450476840: (0.25, 0.000000423570871878283),
                   1451067060: (0.5, 0.000000372722664519784),
                   1451737800: (0.75, -0.000000000172207405497053)
                   }
    keylist = sorted(lookup_dict.keys())
    last = 0
    if target > keylist[-1]:
        return target, lookup_dict[keylist[-1]][0]

    for z in keylist:
        if target >= z:
            last = z
        else:
            return last, lookup_dict[last][0], lookup_dict[last][1]


def prorate_moon(utc_time):
    """
    Prorates moon phase from last known exact moon phase
    :param utc_time: integer representing  UNIX UTC time
    :return moon phase as 3 digit decimal from 0.000 to 0.999
    moonphase covention is 0.0 = new moon, 0.25 = first quarter
                           0.5 = full moon, 0.75 = last quarter
    """
    factor = closest_under(utc_time)
    return round(((utc_time - factor[0]) * factor[2]) + factor[1], 3)


def chk_forecast(key, latude, lngude, dtstamp):
    """
    Construct and execute API calls to forecast.io API

    Forecast.io API call format
    https://api.forecast.io/forecast/APIKEY/LATITUDE,LONGITUDE,TIME

    :param key: API key as supplied by forecast.io
    :param latude: decimal latitude for location in question
    :param lngude: decimal longitude for location in question
    :param dtstamp: date/time for data to be retrieved (yyyymmddhhmm)
    :return: JSON-formatted object NOTE: exact details documented at
             https://developer.forecast.io/docs/v2
    """
    endpt = "https://api.forecast.io/forecast/"
    # construct API call
    key_latlong_time = str(key) + "/" + str(latude) + "," + str(
        lngude) + "," + str(dtstamp) + "?exclude=hourly,flags,minutely"
    getdata = endpt + key_latlong_time
    # execute API call
    call_api = requests.get(getdata)
    results = call_api.json()
    return results

start = time.time()  # for timing script execution.  See last line in script

begin = "201509261700"  # yyyymmddhhmm in local time
api_key = "<insert your forecastio API key here>"    #https://developer.forecast.io/docs/v2
lat = 39.238412  # Larkspur, CO 80118
lng = -104.911221  # Larkspur, CO 80118

dt = int(datetime.timestamp(datetime(int(begin[:4]),
                                     int(begin[4:6]),
                                     int(begin[6:8]),
                                     int(begin[8:10]),
                                     int(begin[10:12]))))

interval = 60  # Seconds. Each call's time will be decremented by this value.
calls = 320  # number of API calls to make.
#  NOTE  API has limit of 1000 calls per day for free.  After that cost is
# $1 per 10,000 calls.    Billing day start = 00:00 UTC

with open('datafile.csv', 'a', newline='') as csvfile:
    wx = csv.writer(csvfile, delimiter=',')
    for x in range(0, calls):
        # make API call
        api_response = chk_forecast(api_key, lat, lng, dt)
        # save off response as a list (of dictionaries)
        collect_data = [api_response]
        #  decrements from begin time by interval value
        dt -= interval
        # data is returned in local time, so I add a field translating that
        # to UTC time
        utc_obsv_time = collect_data[0]['currently'].get(
            'time', -9999) + (3600 * abs(collect_data[0].get('offset', -9999)))

        #  Extract needed data from returned JSON object
        list2write = [utc_obsv_time,
                      collect_data[0]['currently'].get('time', -9999),
                      collect_data[0].get('offset', -9999),
                      datetime.fromtimestamp(
                          collect_data[0]['currently']['time']).strftime(
                          '%Y-%m-%d %H:%M:%S'),
                      collect_data[0]['daily']['data'][0].get('sunriseTime',
                                                              -9999),
                      collect_data[0]['daily']['data'][0]['sunsetTime'],
                      collect_data[0]['currently'].get('temperature', -9999),
                      collect_data[0]['currently'].get(
                          'apparentTemperature', -9999),
                      collect_data[0]['currently'].get('windSpeed', -9999),
                      collect_data[0]['currently'].get('windBearing', -9999),
                      collect_data[0]['currently'].get('humidity', -9999),
                      collect_data[0]['currently'].get('pressure', -9999),
                      collect_data[0]['currently'].get('dewPoint', -9999),
                      collect_data[0]['currently'].get('visibility', -9999),
                      collect_data[0]['currently'].get('cloudCover', -9999),
                      collect_data[0]['currently'].get('summary', -9999),
                      collect_data[0]['currently'].get('precipIntensity',
                                                       -9999),
                      collect_data[0]['currently'].get('precipProbability',
                                                       -9999),
                      collect_data[0]['currently'].get('precipType', 'n/a'),
                      collect_data[0].get('latitude', -9999),
                      collect_data[0].get('longitude', -9999),
                      collect_data[0]['daily']['data'][0].get('moonPhase',
                                                              -9999),
                      prorate_moon(utc_obsv_time)]
        # Writing to file after each call so data won't be lost in event
        # of timeout or failure
        wx.writerow(list2write)

print("Elapsed time to process " + str(calls) +
      " API calls was " + str(time.time() - start) + "  seconds")
